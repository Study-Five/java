## 4.1 스트림이란 무엇인가? 

- 스트림 : 자바8 api 에 추가된 기능. 선언형으로 컬렉션 데이터 처리 가능 
- 멀티스레드 구현 않아도 투명하게 병렬로 처리 가능. 
```java
  public static List<String> getLowCaloricDishesNamesInJava7(List<Dish> dishes) {
    List<Dish> lowCaloricDishes = new ArrayList<>();
    for (Dish d : dishes) {
      if (d.getCalories() < 400) {
        lowCaloricDishes.add(d);
      }
    }
    List<String> lowCaloricDishesName = new ArrayList<>();
    Collections.sort(lowCaloricDishes, new Comparator<Dish>() {
      @Override
      public int compare(Dish d1, Dish d2) {
        return Integer.compare(d1.getCalories(), d2.getCalories());
      }
    });
    for (Dish d : lowCaloricDishes) {
      lowCaloricDishesName.add(d.getName());
    }
    return lowCaloricDishesName;
  }
\
```
```java
  public static List<String> getLowCaloricDishesNamesInJava8(List<Dish> dishes) {
    return dishes.stream()
        .filter(d -> d.getCalories() < 400)
        .sorted(comparing(Dish::getCalories))
        .map(Dish::getName)
        .collect(toList());
  }
```
- 스트림의 sw공학적 장점 
  * 선언형 코드 구현 가능. +동작 파라미터화 + 람다 와 함께 변하는 요구사항에 쉽게 대응
  * filter, sorted, map, collect 같은 빌딩 블록 연산 연결해 데이터 처리 파이프라인 생성 가능 -> 가독성, 명확성 
    
- 고수준 빌딩 블록 으로 이루어져 스레딩 모델에 제한 않고 자유롭게 사용 가능. -> 스레드,락 걱정 ㄴㄴ

- 특징 
  * 선언형 : 더 간결하고 가독성이 좋아진다. 
  * 조립할 수 있음 : 유연성 좋아짐
  * 병렬화 : 성능이 좋아짐 
    
## 4.2 스트림 시작하기 

- 스트림 : 데이터 처리 연산을 지원하도록 소스에서 추출된 연속된 요소 
    * 연속된 요소 : 컬렉션 같이 스트림은 특정 요소 형식으로 이루우진 연속된 값 집합의 인터페이스 제공.
      * 컬렉션 : 자료구조 이므로 시간과 공간의 복잡성과 관련된 요소 저장 및 접근 연산이 주. 주제 : 데이터
      * 스트림 : filter,sorted,map처럼 표현 계산식이 주를 이룸 . 주제 : 계산
    * 소스 : 데이터제공소스(컬렉션,배열,I/O) 부터 테이터를 소비함. 정렬된 컬렉션으로 스트림 생성시 정렬 유지됨
    * 데이터 처리 연산 : 함수형 프로그래밍에서 지원하는 연산과 데이터 베이스와 비슷한 연산 지원. 순차적으로 또는 병렬로 실행 가능 
    * 파이프라이닝 : 스트림 연산끼리 연결해 파이프라인 구성 가능하게 자신을 반환함. 게이름, 쇼트서킷 같은 최적화도 가능 
    * 내부 반복 : 반복자 명시해 반복하는 컬렉션과 달리 스트림은 내부 반복 지원
    

- filter : 람다를 인수로 받아 특정 요소 제외.
- map : 람다 이용해 한 요소를 다른 요소로 변환하거나 정보 추출. 
- limit : 정해진 개수 이상 저장 못하게 스트림 크기 축소 truncate . 
- collect : 스트림을 다른 형식으로 변환. toList() : 리스트로 변환 
    
## 4.3 스트림과 컬렉션 
- 스트림, 컬렉션 모두 연속된 요소 형식 값 저장하는 자료구조의 인터페이스 제공 
  * 연속된 : 순서 상관없이 아무 값 접속x,  순차적 접근
    
- 컬렉션 
  * DVD - 
  * 현재 자료구조가 포함하는 모든 값을 메모리에 저장하는 자료구조. 컬렉션에 추가 하기전 모든 요소 계산 되어야. 
  * 컬렉션에 요소 추가, 삭제 가능 
  * 적극적 생성. 생산자 중심 (판매전 창고 가득 채움)

- 스트림 
  * 인터넷 스트리밍. 시청할 몇 프레임 미리 내려받음
  * 요청할 때만 요소를 계산하는 고정된 자료구조.
  * 스트림에 요소추가, 삭제 불가.
  * 사용자가 요청하는 값만 스트림에서 추출. 생산자와 소비자 관계를 형성. 게으르게 만들어지는 컬렉션 
  * 요청중심 제조, 즉석제조 
    
- 모든 소수 포함하려면 컬렉션은 무한루프 계산 해야해서 불가 , 스트림은 요청한 값만 추출해서 가능 

### 4.3.1 딱 한번만 탐색 할 수 있다. 

- 탐색된 스트림 요소는 소비됨. 한번만 탐색 가능. 다시 하려면 새 스트림 만들어야 함
```java
List<String> title = Arrays.asList("a","b","c");
Stream<String> s = title.stream();
s.forEach(System.out::println);
s.forEach(System.out::println); // java.lang.IllegalStateException
```

### 4.3.2 외부 반복과 내부 반복 

- 외부반복 : 컬렉션에서 사용자가 직접 요소를 반복. ex) for-each . 명시적으로 컬렉션 항몽 하나씩 가져와 처리 
- 내부반복 : 스트림에서 사용. 어떤 작업 수행할지 명시하면 알아서. 투명하게 병렬로 처리하거나 더 최적화된 다양한 순서로 처리 가능   
  데이터 표현과 하드웨어 활용한 병렬성 구현을 자동으로 선택 
  
## 4.4 스트림 연산

### 4.4.1 중간연산

  * filter, map, limit, sorted, distinct  연결할 수 있는 스트림 연산
  * 다른 스트림을 반환. 
  * 단말 연산을 스트림 파이프라인에 실행하기 전까지는 아무 연산도 수행하지 않음 (게으름)
  * 중간 연산을 합친 다음에 합쳐진 중간 연산을 최종연산으로 한번에 처리 
  * 쇼트서킷 , 루프 퓨전 -5장에서 
  
### 4.4.2 최종연산

  * 최종 연산 :  스트림을 닫는 연산. 스트림 파이프라인세ㅓ 결과를 도출
  * List, Integer, void 등 결과 반환
  * forEach, count, collect 

### 4.4.3 스트림 이용하기 

- 질의를 수행할 (컬렉션 같은) 데이터 소스 
- 스트림 파이프 라인을 구성할 중간 연산 연결
- 스트림 파이프 라인을 실행하고 결과를 만들 최종 연산
- 빌더 패턴과 비슷

## 4.5 로드맵 

- 5장에서 연산 더 자세히 보고 사례 보자~
- 복잡한 질의 처리 위한 필터링, 슬라이싱, 검색, 매칭, 매핑, 리듀싱 등의 패턴도~
- 6장에선 데이터 수집을 보자~